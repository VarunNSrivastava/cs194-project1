<!doctype html>
<html>
<head>
	<title>HTML Editor - Full Version</title>
</head>
<body class="vsc-initialized">
<h1 style="font-weight: 400; line-height: 1.2; color: rgb(51, 51, 51); font-family: sans-serif, Arial, Verdana, &quot;trebuchet ms&quot;; text-align: center;"><span style="color:#000000;">CS194-26 Project 1</span></h1>

<h2 style="font-weight: 400; line-height: 1.2; color: rgb(51, 51, 51); font-family: sans-serif, Arial, Verdana, &quot;trebuchet ms&quot;;"><span style="color:#000000;">Overview</span></h2>

<p style="color: rgb(51, 51, 51); font-family: sans-serif, Arial, Verdana, &quot;trebuchet ms&quot;; font-size: 13px;"><span style="font-size:16px;"><span style="color:#000000;">Given the&nbsp;</span><a href="https://inst.eecs.berkeley.edu/~cs194-26/fa22/hw/proj1/data/" style="color: rgb(7, 130, 193);"><span style="color:#000000;">works</span></a><span style="color:#000000;">&nbsp;of Sergei Mikhailovich Prokudin-Gorskii, I have been tasked to reproduce several of his photographs in color.&nbsp;</span></span></p>

<h2 style="font-weight: 400; line-height: 1.2; color: rgb(51, 51, 51); font-family: sans-serif, Arial, Verdana, &quot;trebuchet ms&quot;;"><span style="color:#000000;">Approach</span></h2>

<p><span style="color:#000000;">My approach to align the three images was to&nbsp;identify a &quot;center&quot; pixel for each image, and line them up according to this center pixel. After each image was lined up, they would be cropped to have the same size. The center pixel for the topmost image was chosen arbitrarily, and the centers for the other images was determined by finding which&nbsp;center pixel maximized the Normalized Cross Correlation (NCC) metric.&nbsp;</span></p>

<p><span style="color:#000000;">The search space for the center pixels was a lattice centered near the middle of each individual image, which would increase in fineness over multiple iterations. The combination of a grid search with continually increasing the resolution of the image over iterations is a technique known as</span><a href="https://en.wikipedia.org/wiki/Pyramid_(image_processing)"><span style="color:#000000;"> The Pyramid</span></a><span style="color:#000000;">.&nbsp;</span></p>

<p><span style="color:#000000;">Remark: while my approach of finding centers is functionally similar as&nbsp;calculating &quot;shifts&quot; for NumPy&#39;s roll function, I avoided that approach to make it easier to compare cropped images with NCC.</span></p>

<h2 style="font-weight: 400; line-height: 1.2; color: rgb(51, 51, 51); font-family: sans-serif, Arial, Verdana, &quot;trebuchet ms&quot;;"><span style="color:#000000;">Results</span></h2>

	
<figure>
  <img src="out/cathedral.jpeg" class="img-responsive" alt=""> </div>
  <figcaption>"The Cathedral. Red Center: (840, 191). Green Center: (506, 193). Blue Center: (170, 195). </figcaption>
</figure>
	
<figure>
  <img src="out/church.jpeg" class="img-responsive" alt=""> </div>
  <figcaption>"The Church. Red Center: (7947, 1821). Green Center: (4778, 1813). Blue Center: (1601, 1817). </figcaption>
</figure>

<figure>
  <img src="out/emir.jpeg" class="img-responsive" alt=""> </div>
  <figcaption>"The Emir. Red Center: (7918, 1795). Green Center: (4764, 1827). Blue Center: (1604, 1851). </figcaption>
</figure>

<figure>
  <img src="out/harvesters.jpeg" class="img-responsive" alt=""> </div>
  <figcaption>"The Harvesters. Red Center: (7921, 1827). Green Center: (4767, 1824). Blue Center: (1609, 1841). </figcaption>
</figure>

<figure>
  <img src="out/icon.jpeg" class="img-responsive" alt=""> </div>
  <figcaption>"The Icon. Red Center: (8021, 1847). Green Center: (4825, 1853). Blue Center: (1622, 1870). </figcaption>
</figure>

<figure>
  <img src="out/lady.jpeg" class="img-responsive" alt=""> </div>
  <figcaption>"The Lady. Red Center: (7913, 1868). Green Center: (4763, 1871). Blue Center: (1606, 1880). </figcaption>
</figure>

<figure>
  <img src="out/melons.jpeg" class="img-responsive" alt=""> </div>
  <figcaption>"The Melons. Red Center: (7924, 1872). Green Center: (4779, 1873). Blue Center: (1620, 1885). </figcaption>
</figure>

<figure>
  <img src="out/monastery.jpeg" class="img-responsive" alt=""> </div>
  <figcaption>"The Monastery. Red Center: (849, 193). Green Center: (514, 193). Blue Center: (170, 195). </figcaption>
</figure>

<figure>
  <img src="out/onion_church.jpeg" class="img-responsive" alt=""> </div>
  <figcaption>"The Onion Church. Red Center: (7929, 1854). Green Center: (4771, 1863). Blue Center: (1607, 1890). </figcaption>
</figure>

<figure>
  <img src="out/sculpture.jpeg" class="img-responsive" alt=""> </div>
  <figcaption>"The Sculpture. Red Center: (8002, 1927). Green Center: (4852, 1910). Blue Center: (1628, 1900). </figcaption>
</figure>

<figure>
  <img src="out/self_portrait.jpeg" class="img-responsive" alt=""> </div>
  <figcaption>"The Self Portrait. Red Center: (7951, 1868). Green Center: (4797, 1876). Blue Center: (1625, 1905). </figcaption>
</figure>

<figure>
  <img src="out/three_generations.jpeg" class="img-responsive" alt=""> </div>
  <figcaption>"The Three Generations. Red Center: (7911, 1845). Green Center: (4760, 1843). Blue Center: (1604, 1857). </figcaption>
</figure>

<figure>
  <img src="out/tobolsk.jpeg" class="img-responsive" alt=""> </div>
  <figcaption>"The Tobolsk. Red Center: (845, 194). Green Center: (508, 195). Blue Center: (170, 198). </figcaption>
</figure>

<figure>
  <img src="out/train.jpeg" class="img-responsive" alt=""> </div>
  <figcaption>"The Train. Red Center: (7999, 1837). Green Center: (4815, 1864). Blue Center: (1619, 1870). </figcaption>
</figure>
	
	
<h2 style="font-weight: 400; line-height: 1.2; color: rgb(51, 51, 51); font-family: sans-serif, Arial, Verdana, &quot;trebuchet ms&quot;;"><span style="color:#000000;">Remarks</span></h2>

<p><span style="color:#000000;">Some images caused problems. For example, the&nbsp;center of the bottom (red channel) image of emir converges incorrectly when resolution is initialized too coarsely. In particular, it took some experimentation to find what coarseness to initialize the Pyramid Search. Eventually, I settled on starting resolution as a function of image width, particularly the following:</span></p>

<p style="text-align: center;"><span style="color:#000000;">res = 1 / (10 + 0.014 * width)&nbsp;</span></p>

<p><span style="color:#000000;">This is fairly arbitrary, but a&nbsp;wide range of initial values seems to work.</span></p>

<p><span style="color:#000000;">The color image of the emir is the most imperfect. I suspect the alignment is a few pixels off, probably because the three channels for the emir have different brightness levels.</span></p>

<p>&nbsp;</p>
</body>
</html>
